Pophelper 2.3.0 is a R package that can be used to plot the struture figure. 
The detailed tutorials could be found in: http://www.royfrancis.com/pophelper/articles/index.html

1. Installation
#install the packages 
install.packages(c("devtools","ggplot2","gridExtra","gtable","label.switching","tidyr"),dependencies=T)
install.packages('pophelper')
# load library
library(pophelper)
The next step is to set the working directory. The working directory is a folder that usually contains the run files of interest so as to allow R to access it. 

2. Input files 
(this protocol is specifically for the analysis of fastSTRUCTURE)
The input file for fastSTRUCTURE should be the meanQ file. meanQ file is the file with contribution of each cluster for each sample. 
pop_k_5_reoder<-readQ('meanQ_5.csv')
#use the 'readQ' in Pophelper to read the data into R and covert to a 'qlist' filetype.
attributes(pop_k_5_reoder[[1]])
#use the 'attributes' to check the facts of the data, like number of individual, the number of k. 

3.Plot the figures 
plotQ(pop_k_5_reoder[1],grplab = g_labels_reorder, sortind='all', clustercol=c("coral","steelblue","lightblue","purple","orange"), imgtype = 'pdf')

#pop_k_5_reorder is the qlist
#grplab is the labels for the group name
#sortind. Individuals in a plot are by default plotted in the order as in the input data. 
The individuals can be sorted based on the value of any one of the clusters (‘Cluster1’), ‘all’ or ‘label’. The ‘all’ option produces a sort similar to that in the software STRUCTURE. All clusters are taken into account to sort individuals. When using the name of a cluster, like ‘Cluster1’, ‘Cluster2’ etc, all individuals are sorted by value of the specified cluster.
#clustercol. Each cluster gets a distinct colour. You can use clustercol to set up the color. You can check the website to choose the color. 
#imgtype. Normally I save the output as the pdf file. 

Notes(tricky part):
1. how to group the samples within the group together? 
The meanQ file does not contain the sample name information, which is also the reason you need the 
The sample name for each row align with the sample order when you conduct the SNP calling. You should create a file with the ID, sample name and the group information like the example file Populations.csv.
You can combine this information with the meanQ file in the excel and create a new file. 

